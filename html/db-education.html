<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Portal</title>
    <link rel="stylesheet" href="../src/css/reset.css">
    <link rel="stylesheet" href="../src/css/common.css">
    <link rel="stylesheet" href="../src/css/typeA.css">
    <script src="../src/js/common.js" defer></script>
    <script src="../src/js/typeA.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script> <!-- sample data -->
    <script src="https://code.highcharts.com/highcharts-3d.js"></script> <!-- sample data -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script> <!-- sample data -->
    <script src="https://cdn.jsdelivr.net/npm/echarts-gl/dist/echarts-gl.min.js"></script> <!-- sample data -->
</head>
<body>
<!-- header -->
<div id="header"></div>
<script>
    setTimeout(() => {
        document.getElementById('population-link').classList.add('active'); /* 인구통계 active */
    }, 50);
</script>
<!-- //header -->
<section>
    <h1 class="blind">교육현황</h1>
    <!-- type A -->
    <div class="type_a_wrap layout">
        <div class="type_a_gird">
            <div class="a_colum a_left ac3">
                <div class="type_list list_board">
                    <div class="title sb">
                        <p class="tit">학생, 교사현황(명)</p>
                        <a href="javascript:;" onclick="showPopup(this);" class="more_btn" data-id="lp01">더보기</a>
                    </div>
                    <div class="data_area">
                       <!-- sample data : tab/table - highcharts.js -->
                        <div class="db-table">
                            <div class="table-wrap">
                                <div class="table-header">
                                <div class="tabs graph-tabs">
                                    <button class="active" data-type="전체">전체</button>
                                    <button data-type="유치원">유치원</button>
                                    <button data-type="초등">초등</button>
                                    <button data-type="중등">중등</button>
                                    <button data-type="고등">고등</button>
                                </div>
                                </div>
                                <div class="data_inner_tw">
                                <div id="line-container" style="width:55%; height:150px;"></div>
                                <div id="donut-container" style="width:40%; height:150px;"></div>
                                </div>
                            </div>
                            </div>

                            <script>
                            const graphTabs = document.querySelectorAll('.graph-tabs button');

                            graphTabs.forEach(btn => {
                            btn.addEventListener('click', () => {
                                graphTabs.forEach(b => b.classList.remove('active'));
                                btn.classList.add('active');
                                renderGraph(btn.dataset.type);
                            });
                            });

                            function renderGraph(type) {
                            const lineData = {
                                '전체': [1400000,1350000,1300000,1250000,1200000,1150000,1100000,1050000,1000000,950000],
                                '유치원': [300000,290000,280000,270000,260000,250000,240000,230000,220000,210000],
                                '초등': [600000,590000,580000,570000,560000,550000,540000,530000,520000,510000],
                                '중등': [300000,295000,290000,285000,280000,275000,270000,265000,260000,255000],
                                '고등': [200000,190000,185000,180000,175000,170000,165000,160000,155000,150000]
                            };

                            // 라인 차트
                            Highcharts.chart('line-container', {
                                chart: { type: 'line', backgroundColor: 'transparent' },
                                title: null,
                                xAxis: { categories: [2015,2016,2017,2018,2019,2020,2021,2022,2023,2024] ,
                                    style: { color: 'var(--ft-cl-gray)' },
                                    labels: { style: { color: 'var(--ft-cl-gray)' } }, 
                                    lineColor: 'var(--ft-cl-gray)',
                                    tickColor: 'var(--ft-cl-gray)' 
                                },
                                yAxis: { title: { text: '명' , style: { color: 'var(--ft-cl-gray)' }},
                                            style: { color: 'var(--ft-cl-gray)' },
                                            labels: { style: { color: 'var(--ft-cl-gray)' } }, 
                                            lineColor: 'var(--ft-cl-gray)',
                                            tickColor: 'var(--ft-cl-gray)' 
                                        },
                                series: [{ name: type + ' 학생수', data: lineData[type] || [] }]
                            });

                            // 도넛 차트
                            Highcharts.chart('donut-container', {
                                chart: { type: 'pie', backgroundColor: 'transparent' },
                                title: null,
                                plotOptions: { pie: { innerSize: 50, depth: 45 } },
                                series: [{
                                name: '비율',
                                data: [['학생', (lineData[type]||[]).reduce((a,b)=>a+b,0)], ['교원', 90000]]
                                }]
                            });
                            }

                            renderGraph('전체');
                            </script>
                        <!-- //sample data : tab/table - highcharts.js -->
                    </div>
                </div>
                <div class="type_list list_keyword">
                    <div class="title sb">
                        <p class="tit">학급당 학생수(명)</p>
                        <a href="javascript:;" onclick="showPopup(this);" class="more_btn" data-id="lp02">더보기</a>
                    </div>
                    <div class="data_area">
                        <!-- sample data : highcharts.js -->
                        <div class="db-graph">
                        <div class="graph-header">
                            <div class="tabs line-tabs">
                            <button class="active" data-type="초등학교">초등학교</button>
                            <button data-type="중학교">중학교</button>
                            <button data-type="고등학교">고등학교</button>
                            </div>
                        </div>

                        <div id="container02" style="height:200px;"></div>
                        </div>

                        <script>
                        const graphTabs00 = document.querySelectorAll('.line-tabs button');

                        graphTabs00.forEach(btn => {
                        btn.addEventListener('click', () => {
                            graphTabs00.forEach(b => b.classList.remove('active'));
                            btn.classList.add('active');
                            renderLineGraph(btn.dataset.type);
                        });
                        });

                        function renderLineGraph(type) {
                        const seriesData = {
                            '초등학교': [26.8, 25.7, 23.8, 23.0, 22.8],
                            '중학교': [22.9, 21.7, 21.0, 20.5, 20.0],
                            '고등학교': [20.5, 19.8, 19.2, 18.7, 18.3]
                        };

                        Highcharts.chart('container02', {
                            chart: { type: 'line', backgroundColor: 'transparent', height: 170 },
                            title: null,
                            xAxis: { categories: [2015, 2016, 2017, 2018, 2019],
                            labels: { style: { color: 'var(--ft-cl-gray)' } },
                            lineColor: 'var(--ft-cl-gray)', tickColor: 'var(--ft-cl-gray)'
                            },
                            yAxis: { title: { text: '학생수', style: { color: 'var(--ft-cl-gray)' } },
                            labels: { style: { color: 'var(--ft-cl-gray)' } },
                            lineColor: 'var(--ft-cl-gray)', tickColor: 'var(--ft-cl-gray)'
                            },
                            series: [{
                            name: type,
                            data: seriesData[type] || []
                            }]
                        });
                        }

                        renderLineGraph('초등학교');
                        </script>
                        <!-- //sample data : highcharts.js -->
                    </div>
                </div>
                <div class="type_list list_graph">
                    <div class="title sb">
                        <p class="tit">학생수 변동 현황(명)</p>
                        <a href="javascript:;" onclick="showPopup(this);" class="more_btn" data-id="lp03">더보기</a>
                    </div>
                    <div class="data_area">
                        <!-- sample data : highcharts.js -->
                        <div id="container03"></div>
                        <script>
                        Highcharts.chart('container03', {
                        chart: { type: 'bar',
                            backgroundColor: 'transparent',
                            height: 200
                         },
                        // title: { text: '학생수 변동 현황' },
                        title: null,
                        xAxis: {
                            categories: ['고등학교', '중학교', '초등학교', '유치원'],
                            style: { color: 'var(--ft-cl-gray)' },
                            labels: { style: { color: 'var(--ft-cl-gray)' } }, 
                            lineColor: 'var(--ft-cl-gray)',
                            tickColor: 'var(--ft-cl-gray)' 
                        },
                        yAxis: {
                            min: 0,
                            title: { text: '학생수 (명)' , style: { color: 'var(--ft-cl-gray)' }},
                            style: { color: 'var(--ft-cl-gray)' },
                            labels: { style: { color: 'var(--ft-cl-gray)' } }, 
                            lineColor: 'var(--ft-cl-gray)',
                            tickColor: 'var(--ft-cl-gray)' 
                        },
                        series: [{
                            name: '2024년',
                            data: [205784, 195738, 363157, 61128]
                        }]
                        });
                        </script>
                        <!-- //sample data : highcharts.js -->
                    </div>
                </div>
            </div>
            <div class="a_colum a_center ac2">
                <div class="type_list list_map">
                    <div class="title">
                        <p class="tit">map</p>
                        <div class="info_box">
                            <span class="info_icon"></span>
                            <p class="info_tag">각 지역을 클릭하시면, 해당 지역의 데이터를 확인하실 수 있습니다.</p>
                        </div>
                    </div>
                    <div class="data_area map_data">
                        <!-- smaple data : img -->
                        <img src="../src/assets/images/map01.png" alt="map" style="display: block;width: 100%; height: 100%;"/>
                        <!-- //smaple data : img -->
                    </div>
                </div>
                <div class="type_list list_stats">
                    <div class="title sb">
                        <p class="tit">서울특별시 초등학교 수</p>
                        <a href="javascript:;" onclick="showPopup(this);" class="more_btn" data-id="lp04">더보기</a>
                    </div>
                    <div class="data_area">
                        <!-- sample data : echarts.js -->
                        <div id="bar3d" style="width: 100%; height: 330px;"></div>

                        <script>
                        window.addEventListener('load', function() {
                            var container = document.getElementById('bar3d');
                            var chart = echarts.init(container);

                            var xData = ['강남구','서초구','송파구'];
                            var yData = ['2022','2023','2024'];
                            var seriesData = [
                                [0,0,12],[0,1,18],[0,2,15],
                                [1,0,9],[1,1,14],[1,2,20],
                                [2,0,8],[2,1,16],[2,2,10]
                            ];

                            function getOption() {
                                var w = container.offsetWidth;
                                var h = container.offsetHeight;

                                return {
                                    tooltip: {},
                                    visualMap: { max: 20, inRange: { color: ['#87CEFA','#FF69B4'] } },
                                    xAxis3D: { type: 'category', data: xData },
                                    yAxis3D: { type: 'category', data: yData },
                                    zAxis3D: { type: 'value' },
                                    grid3D: {
                                        boxWidth: 200,
                                        boxDepth: 80,
                                        boxHeight: 200,
                                        viewControl: {
                                            alpha: 30,
                                            beta: 0,
                                            center: [0,0,0],
                                            distance: 200,
                                            zoomSensitivity: 2 // 기본 1, 값을 키우면 휠 반응 빨라짐
                                        },
                                        light: { main: { intensity: 1.2 } }
                                    },
                                    series: [{
                                        type: 'bar3D',
                                        data: seriesData,
                                        shading: 'lambert'
                                    }],
                                    tooltip: { show: false }
                                };
                            }

                            chart.setOption(getOption());

                            window.addEventListener('resize', function() {
                                chart.resize();
                                chart.setOption(getOption());
                            });
                        });
                        </script>
                        <!-- //sample data : echarts.js -->
                    </div>
                </div>
            </div>
            <div class="a_colum a_right ac3">
                <div class="type_list news">
                    <div class="title sb">
                        <p class="tit">초,중,고등학교 급식현황</p>
                        <a href="javascript:;" onclick="showPopup(this);" class="more_btn" data-id="lp05">더보기</a>
                    </div>
                    <div class="data_area video_data">
                        <img src="../src/assets/images/news_enpyeonggu.gif">
                    </div>
                </div>
                <div class="type_list left">
                    <div class="title sb">
                        <p class="tit">지역별 학생수(명)</p>
                        <a href="javascript:;" onclick="showPopup(this);" class="more_btn" data-id="lp06">더보기</a>
                    </div>
                    <div class="box_cont scroll">
                    <!-- sample data : tab/table -->
                    <div class="db-table">
                        <div class="table-wrap">
                            <div class="table-header">
                            <div class="tabs table-tabs">
                                <button class="active" data-type="전체">전체</button>
                                <button data-type="유치원">유치원</button>
                                <button data-type="초등">초등</button>
                                <button data-type="중등">중등</button>
                                <button data-type="고등">고등</button>
                            </div>
                            </div>

                            <table>
                            <thead>
                                <tr>
                                <th>No</th>
                                <th>자치구</th>
                                <th>재학생수</th>
                                <th>교원수</th>
                                <th>교원 1인당 학생수</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody"></tbody>
                            </table>
                        </div>
                        </div>

                        <script>
                        const tableData = {
                        전체: [
                            {no:1, name:'종로구', student:975, teacher:94, ratio:9.7},
                            {no:2, name:'중구', student:897, teacher:90, ratio:10.0}
                        ],
                        유치원: [
                            {no:1, name:'종로구', student:120, teacher:15, ratio:8.0}
                        ],
                        초등: [
                            {no:1, name:'용산구', student:620, teacher:55, ratio:11.3}
                        ],
                        중등: [
                            {no:1, name:'광진구', student:910, teacher:88, ratio:10.3}
                        ],
                        고등: [
                            {no:1, name:'중랑구', student:980, teacher:90, ratio:10.8}
                        ]
                        };

                        const tbody = document.getElementById('tableBody');
                        const tableTabs = document.querySelectorAll('.table-tabs button');

                        function renderTable(type) {
                        tbody.innerHTML = '';
                        (tableData[type] || []).forEach(row => {
                            tbody.innerHTML += `
                            <tr>
                                <td>${row.no}</td>
                                <td>${row.name}</td>
                                <td>${row.student.toLocaleString()}</td>
                                <td>${row.teacher}</td>
                                <td>${row.ratio}</td>
                            </tr>
                            `;
                        });
                        }

                        renderTable('전체');

                        tableTabs.forEach(btn => {
                        btn.addEventListener('click', () => {
                            tableTabs.forEach(b => b.classList.remove('active'));
                            btn.classList.add('active');
                            renderTable(btn.dataset.type);
                        });
                        });
                        </script>
                    <!-- //sample data : tab/table -->

                    </div>
                </div>
                <div class="type_list right">
                    <div class="title sb">
                        <p class="tit">서울시 급식 인력(명)</p>
                        <a href="javascript:;" onclick="showPopup(this);" class="more_btn" data-id="lp07">더보기</a>
                    </div>
                    <div class="box_cont">
                        <!-- sample data : highcharts.js -->
                        <div class="data_inner_tw">
                            <div id="bar-container" style="width: 55%; height: 200px;"></div>
                            <div id="donut-container02" style="width: 40%; height: 200px;"></div>
                        </div>
                        <script>
                        // 왼쪽: 바 차트
                        Highcharts.chart('bar-container', {
                        chart: { type: 'bar' , backgroundColor: 'transparent'},
                        // title: { text: '서울시 급식 인력' },
                        title: null,
                        xAxis: {
                            categories: ['조리원', '조리사', '영양사'],
                            title: { text: null },
                            style: { color: 'var(--ft-cl-gray)' },
                            labels: { style: { color: 'var(--ft-cl-gray)' } }, 
                            lineColor: 'var(--ft-cl-gray)',
                            tickColor: 'var(--ft-cl-gray)'
                        },
                        yAxis: {
                            min: 0,
                            title: { text: '명', align: 'high' , style: { color: 'var(--ft-cl-gray)' }},
                            style: { color: 'var(--ft-cl-gray)' },
                            labels: { style: { color: 'var(--ft-cl-gray)' } }, 
                            lineColor: 'var(--ft-cl-gray)',
                            tickColor: 'var(--ft-cl-gray)'
                        },
                        plotOptions: {
                            bar: {
                            dataLabels: { enabled: true }
                            }
                        },
                        series: [{
                            name: '인원',
                            data: [23521, 5007, 5540]  // 샘플 값
                        }]
                        });

                        // 오른쪽: 3D 도넛
                        Highcharts.chart('donut-container02', {
                        chart: {
                            type: 'pie',
                            backgroundColor: 'transparent',
                            options3d: {
                            enabled: true,
                            alpha: 45
                            }
                        },
                        // title: { text: '급식 인력 비율' },
                        title: null,
                        plotOptions: {
                            pie: {
                            innerSize: 50,
                            depth: 45,
                            dataLabels: {
                                enabled: true,
                                format: '{point.name}: {point.percentage:.1f} %'
                            }
                            }
                        },
                        series: [{
                            name: '비율',
                            data: [
                            ['조리원', 23521],
                            ['조리사', 5007],
                            ['영양사', 5540]
                            ]
                        }]
                        });
                        </script>
                        <!-- //sample data : highcharts.js -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- //type A -->
</section>
<!-- layer popup -->
<div id="layerPopup" class="popup_wrap">
  <div class="popup_inner">
    <button class="popup_close" onclick="closePopup()">
        <svg width="24" height="24" viewBox="0 0 24 24">
            <line x1="4" y1="4" x2="20" y2="20" stroke="black" stroke-width="2"/>
            <line x1="20" y1="4" x2="4" y2="20" stroke="black" stroke-width="2"/>
        </svg>
    </button>
    <div id="popupContent"></div>
  </div>
</div>
<!-- //layer popup -->

</body>
<script>
    // popup
    const popupData = {
        lp01: "<img src='../src/assets/images/sample/sample_03_img01.png'>",
        lp02: "<img src='../src/assets/images/sample/sample_03_img02.png'>",
        lp03: "<img src='../src/assets/images/sample/sample_03_img03.png'>",
        lp04: "<img src='../src/assets/images/sample/sample_03_img04.png'>",
        lp05: "<img src='../src/assets/images/sample/sample_03_img05.png'>",
        lp06: "<img src='../src/assets/images/sample/sample_03_img06.png'>",
        lp07: "<img src='../src/assets/images/sample/sample_03_img07.png'>",
    };
    function showPopup(el) {
        const id = el.dataset.id; 
        document.getElementById('popupContent').innerHTML = popupData[id] || "<p>데이터 없음</p>";
        document.getElementById('layerPopup').style.display = 'block';
    }
    function closePopup() {
        document.getElementById('layerPopup').style.display = 'none';
    }
</script>
</html>